<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Let us discuss about security">
    <meta name="author" content="3kara &lt;adm1n.3kara@protonmail.com&gt;">
    <meta name="twitter:card" content="summary" /> <!--Page Cover-->
    
    <title>Pentesting SCADA Services and Protocols - 3kara</title> 
    
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.1/css/all.css" integrity="sha384-xxzQGERXS00kBmZW/6qxqJPyxW3UR0BPsL4c8ILaIWXva5kFi7TxkIIaMiKtqV1Q" crossorigin="anonymous">
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/style.css">

</head>

<body>
    <a href="javascript:" id="rtt"><i class="fas fa-chevron-up"></i></a>
    <div class="bg-gradient"></div>
    <div class="bg-pattern"></div>
    
    <!--Menu Links and Overlay-->
    <div class="menu-bg">
        <div class="menu-container">
            <ul>
                <li class="menu-item"><a href="/">Home</a></li>
                <li class="menu-item"><a href="/api">API</a></li>
                <li class="menu-item"><a href="/blog">Blog</a></li>
                <li class="menu-item"><a href="/ics">ICS</a></li>
                <li class="menu-item"><a href="/oscp">Oscp</a></li>
                <li class="menu-item"><a href="/search">Search <i class="fas fa-search"></i></a>
            </ul>
        </div>
    </div>
    
    <!--Hamburger Icon-->
    <nav>
        <a href="#menu"></a>
    </nav>
    
    <div class="container">
    
        <!-- Main Content -->
        <div class="row">
        <div class="col-sm-12">
    
        <!--Title and Logo-->
        <header>
        <div class="logo">
            <a href="/"><i class="logo-icon rotate linear infinite fas fa-dharmachakra" aria-hidden="true"></i></a>
            <h1 id="main-title" class="title">ICS</h1>
        </div>
        </header>
    
    <section class="main">
                
                     
    <div class="post">
    
        <div class="post-header">
            <h1 class="title"><a href="/ics/ics-scada-security/pentesting-scada-services-and-protocols">Pentesting SCADA Services and Protocols</a></h1>
        </div>
    
        <div class="content">

            <h2 id="ass"><a href="#ass" class="headerlink" title="ass"></a>Attacking Standard Services</h2><br>
            <h4 id="ia"><a href="#ia" class="headerlink" title="ia"></a>ICS Attacks</h4>
            <p>Types of Attacks</p>
            <ul>
                <li>Directed (targeted)</li>
                <li>Undirected (indiscriminate)</li>
            </ul>
            <p>How Attacked</p>
            <ul>
                <li>Attach to the console / diagnostic port</li>
                <li>Attach to a field device</li>
                <li>Send commands via the data highway (Internet)</li>
                <li>Connect via a dial-in telephone port (war dialing)</li>
            </ul>
            <p>Type of Attacks</p>
            <ul>
                <li>Denial of service (DOS)</li>
                <li>Download control logic</li>
                <li>Upload new control logic</li>
                <li>Alter a critical processes</li>
            </ul>
            <h2 id="aip"><a href="#aip" class="headerlink" title="aip"></a>Attacking ICS Protocols</h2><br>
            <h4 id="pi"><a href="#pi" class="headerlink" title="pi"></a>Protocol Insecurity</h4><br>
            <ul>
                <li>SCADA protocols were not built with security in mind</li>
                <li>As modern technologies (web interfaces, interactive consoles, remote configuration protocols) are adopted, many possibilities for attacks open up</li>
                <li>Most SCADA protocols are</li>
                <ul>
                    <li>not blocked by firewalls/switches</li>
                    <li>accessible between LAN segments</li>
                    <li>work from data link layer to application layer</li>
                    <li>easy to detect, intercept, analyze, reproduce, and replay</li>
                </ul>
            </ul>
            <h4 id="pma"><a href="#pma" class="headerlink" title="pma"></a>Possible Modbus Attacks</h4><br>
            <ul>
                <li>Force Listen Only Mode</li>
                <li>Restart Communications Option</li>
                <li>Clear Counters and Diagnostic Registers</li>
                <li>Read Device Identification</li>
                <li>Report Slave ID</li>
                <li>Unauthorized Read Request to a PLC</li>
                <li>Unauthorized Write Request to a PLC</li>
                <li>Illegal Packet Size, Possible DOS Attack</li>
                <li>Non-Modbus Communication on TCP Port 502</li>
                <li>Slave Device Busy Exception Code Delay</li>
                <li>Acknowledge Exception Code Delay</li>
                <li>Incorrect Packet Length, Possible DOS Attack</li>
                <li>Points List Scan</li>
                <li>Function Code Scan</li>
            </ul>
            <h4 id="pda"><a href="#pda" class="headerlink" title="pda"></a>Possible DNP3 Attacks</h4><br>
            <ul>
                <li>Disable Unsolicited Responses</li>
                <li>Non-DNP3 Communication on a DNP3 Port</li>
                <li>Unsolicited Response Storm</li>
                <li>Cold Restart from Authorized Client</li>
                <li>Cold Restart from Unauthorized Client</li>
                <li>Unauthorized Read Request to a PLC</li>
                <li>Unauthorized Write Request to a PLC</li>
                <li>Unauthorized Miscellaneous Request to a PLC</li>
                <li>Stop Application</li>
                <li>Warm Restart</li>
                <li>Broadcast Request from an Authorized Client</li>
                <li>Broadcast Request from an Unauthorized Client</li>
                <li>Points List Scan</li>
                <li>Function Code Scan</li>
                <li>Time Change Attempt</li>
                <li>Failed Checksum Error</li>
            </ul>
            <h4 id="pia"><a href="#pia" class="headerlink" title="pia"></a>Possible ICCP Attacks</h4><br>
            <ul>
                <li>COTP Connection Request From Unauthorized Client</li>
                <li>Unauthorized COTP Connection Established</li>
                <li>Unauthorized Association Request</li>
                <li>Unauthorized MMS Write Request Attempt</li>
                <li>Unauthorized MMS Write Succeeded</li>
                <li>COTP Disconnect (Address Unknown)</li>
                <li>COTP Disconnect (Protocol Error)</li>
                <li>Invalid OSI-SSEL (Refuse PDU)</li>
                <li>Invalid OSI PSEL (ACSE Abort PDU)</li>
                <li>Non-TPKT/ICCP Communication on TCP Port 102</li>
            </ul>
            <h4 id="pceia"><a href="#pceia" class="headerlink" title="pceia"></a>Possible CIP Ethernet /IP Attacks</h4><br>
            <ul>
                <li>Reboot or Restart from Unauthorized Client</li>
                <li>Reboot or Restart from Authorized Client</li>
                <li>Unlock PLC Attempt from Unauthorized Client</li>
                <li>Unlock PLC Attempt from Authorized Client</li>
                <li>Stop Detected from Unauthorized Client</li>
                <li>Stop Detected from Authorized Client</li>
                <li>Remote Mode Change Attempt from Unauthorized Client</li>
                <li>Remote Mode Change Attempt from Authorized Client</li>
                <li>Software Upload from Unauthorized Client</li>
                <li>Software Upload from Authorized Client</li>
            </ul>
            <h4 id="ppa"><a href="#ppa" class="headerlink" title="ppa"></a>Possible PROFIBUS/PROFINET Attack</h4><br>
            <ul>
                <li>Scan supported devices and stations</li>
                <li>Change name of the station</li>
                <li>Change IP, netmask, gateway</li>
                <li>Request full network information</li>
            </ul>
            <h4 id="pba"><a href="#pba" class="headerlink" title="pba"></a>Possible BACnet Attacks</h4><br>
            <ul>
                <li>I-am floods</li>
                <li>Possible Who-has floods</li>
                <li>Discovery scans</li>
                <li>Change priority</li>
                <li>Change setpoint</li>
                <li>Change schedule</li>
                <li>Change program</li>
            </ul>
            <h4 id="pe"><a href="#pe" class="headerlink" title="pe"></a>Protocol Exploitation</h4><br>
            <p>Two possibilities for sending ICS/SCADA control messages:</p>
            <ul>
                <li>Gaining control of the host</li>
                <ul><li>Even encrypted messages can be sent if encryption happens on that host</li></ul>
                <li>Performing a Man-in-the-Middle attack to get in-between communicating devices and intercept/modify/replay/inject control messages</li>
            </ul>
            <h4 id="at"><a href="#at" class="headerlink" title="at"></a>Attack Tools</h4><br>
            <p>After a successful MitM attack is performed, various tools can be used to intercept and manipulate ICS/SCADA traffic</p>
            <ul>
                <li>Sniffing tools (Wireshark)</li>
                <li>General purpose packet crafting tools (Netcat, Hping, Scapy, etc.)</li>
                <li>Specialized ICS/SCADA pentesting tools, including</li>
                <ul>
                <li>mbtget — simple Modbus PLC client read/write tool</li>
                <li>SMOD — Scapy-based Modbus pentesting framework</li>
                <li>Metasploit modules</li>
                </ul>
            </ul>
            <h4 id="pf"><a href="#pf" class="headerlink" title="pf"></a>Protocol Fuzzing</h4><br>
            <ul>
                <li>Fuzzing (fuzz-testing) — a software testing technique that involves providing invalid, unexpected, or random test inputs to the software system under test. The system is then monitored for crashes and other undesirable behavior.</li>
                <li>What can fuzzing SCADA protocols detect?</li>
                <ul>
                <li>Protocol anomalies</li>
                <li>Unauthorized master/slave communication</li>
                <li>Unauthorized master/slave command execution</li>
                <li>DOS attack possibilities</li>
                </ul>
                <li>Two approached to fuzzing: Mutation-based and Generation-based</li>
            </ul>
            <h4 id="sft"><a href="#sft" class="headerlink" title="sft"></a>SCADA Fuzzing Tools</h4><br>
            <ul>
                <p>sulley</p>
                <li>Not limited to SCADA fuzzing, but includes SCADA specific helper routines including DNP3 block encoder</li>
                <p>LZfuzz (Lazy-fuzz)</p>
                <li>Performs APR-poisoning MitM on the targets</li>
                <li>Rewrites packets in transit</li>
                <li>If connection is broken, stops and wait for it to be re-established</li>
                <p>beSTORM (commercial)</p>
                <li>Protocol fuzzer</li>
                <li>Includes 13 inductrial/SCADA/automotive modules (including Ethernet/lP, DNP3, PROFINET RT)</li>
            </ul>
            <h2 id="awc"><a href="#awc" class="headerlink" title="awc"></a>Attacking Wireless Communication</h2><br>
            <h4 id="wi"><a href="#wi" class="headerlink" title="wi"></a>Wireless Insecurity</h4><br>
            <ul>
                <p>Traditionally, SCADA systems employed wired technology for networking<br>Wireless technology introduced numerous benefits but also opened up additional attack possibilities</p>
                <li>New physical boundary for network, how far does it extend?</li>
                <li>Native wireless encryption (WEP) is seriously flawed and can be broken</li>
                <li>Many security/obscurity features are easy to overcome</li>
                <li>Even with strong encryption (not WEP) we can do a replay attack get unencrypted traffic</li>
                <li>Access points can be abused or malicious access points can be installed</li>
                <li>Lots of DOS problems</li>
            </ul>
            <h4 id="wt"><a href="#wt" class="headerlink" title="wt"></a>Wireless Threats</h4><br>
            <ul>
                <p>Shared medium</p>
                <li>You cannot physically protect wireless medium</li>
                <li>Traffic can be monitored by attackers</li>
                <li>MitM attacks are possible</li>
                <p>WEP (Wireless Equivalent Privacy) cracking</p>
                <li>Weak security, officially deprecated in 2004</li>
                <li>Still used by many legacy systems</li>
                <li>Very little technical skill needed to quickly recover the network key</li>
                <p>WPA (Wi-Fi Protected Access) and WPA2 cracking</p>
                <li>Much stronger than WEP, but cracking is still possible</li>
                <li>Weak passphrases can be brute-forced</li>
                <p>DOS - Jamming and Resource depletion</p>
                <li>Powerful signal jammers can be easily built</li>
                <li>Access Points can be overwhelmed by multiple fake authentication requests </li>
                <p>Rogue Access Points</p>
                <li>Impersonating a legitimate AP by copying its SSID</li>
                <li>Rogue AP may be placed closer to the client or legitimate AP can be blocked (see above)</li>
                <li>Client would attempt to connect to the rogue IP</li>
                <li>If attacker is able to login to legitimate AP, a MitM attack can be performed</li>
                <p>Injection Attacks</p>
                <li>Capture requests with packet sniffer</li>
                <li>Use packet injection tools (Airpwn) to craft and send fake reply messages before server responds</li>
                <li>Legitimate replies will be rejected as erroneous</li>
                <p>Analog wireless eavesdropping</p>
                <li>Headsets, microphones, cordless phones, wireless keyboards</li>
                <li>No encryption or optional (in most cases not implemented)</li>
                <li>Eavesdropping on conversations, capturing keystrokes</li>
                <li>KeyKeriki — free tool for keyboard sniffing and remote command execution</li>
            </ul>
            <h2 id="sac"><a href="#sac" class="headerlink" title="sac"></a>SCADA Access Control</h2><br>
            <h4 id="tsc"><a href="#tsc" class="headerlink" title="tsc"></a>Types of System Controls</h4><br>
            <ul>
                <p>Administrative Controls</p>
                <li>People and Processes</li>
                <li>Security policies and procedures</li>
                <li>Security awareness</li>
                <p>Technical / Logical Controls</p>
                <li>Security Software</li>
                <li>Firewalls, IDS, smart cards</li>
                <li>Security configurations</li>
                <li>Access control in a SCADA application</li>
                <p>Physical Controls</p>
                <li>Locks, doors, guards, alarms, CCTV</li>
            </ul>
            <h4 id="csc"><a href="#csc" class="headerlink" title="csc"></a>Categories of System Controls</h4><br>
            <ul>
                <p>Preventive</p>
                <li>Put in place to inhibit harmful occurrences</li>
                <p>Detective</p>
                <li>To establish or discover harmful occurrences</li>
                <p>Corrective</p>
                <li>To restore systems that are victims of harmful occurrences</li>
            </ul>
            <h4 id="ism"><a href="#ism" class="headerlink" title="ism"></a>ICS Security Myths</h4><br>
            <ul>
                <li>Firewalls make you secure</li>
                <li>DMZ's make you secure</li>
                <li>VPNs make you secure</li>
                <li>Encryption makes you secure</li>
                <li>IDSs cannot identify possible control system attacks</li>
                <li>Messaging can be one-way</li>
                <li>Field devices can't be hacked</li>
                <li>You can keep hackers out</li>
                <li>You are secure if hackers can't get in</li>
                <li>More and better widgets can solve security problems</li>
            </ul>
            <h4 id="acm"><a href="#acm" class="headerlink" title="acm"></a>Access Control Models</h4><br>
            <ul>
                <li>Group Based Access Control (GBAC)</li>
                <li>Role Based Access Control (RBAC)</li>
                <li>Location Based Access Control (LBAC)</li>
                <li>Station Based Access Control (SBAC)</li>
                <li>View Based Access Control (VBAC)</li>
                <li>Time Based Access Control (TBAC)</li>
                <li>Area of Responsibility (AOR)</li>
            </ul>
        </div>  
        
    </div>
                   
    </section>
    </div>
    </div>

    </div>
    
    <!-- Footer -->
    <div class="push"></div>
    
    <footer class="footer-content">
        <div class="container">
            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                    <h2><a href="#">About</a></h2>
                    <p>3kara is the source for security concepts and information about Web, Mobile and API along with few Walkthroughs, Best practices, Cheatsheets, Custom Scripts, Tips & Techniques.</p>
                    <p>Our goal is to spread enthusiasm, awareness and joy on information security as well as to document and share what we were able to learn  along the way.</p>
                </div>
                
                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-contact">
                    <h2>Contact</h2>
                    <p>For queries, Contact us at adm1n.3kara@protonmail.com</p>
                    <p>Stuck somewhere? Don't hesitate</p> 
                    <p>Contact author directly by clicking on their name.</p>
                </div>
                
    </div>
            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                    <ul class="list-inline footer-social-icons">
                        
                        <li class="list-inline-item"><a href="https://3kara.github.com"><span class="footer-icon-container"><i class="fab fa-github"></i></span></a></li>
                        <li class="list-inline-item"><a href="https://twitter.com/_3kara?lang=en"><span class="footer-icon-container"><i class="fab fa-twitter"></i></span></a></li>
                        <li class="list-inline-item"><a href="https://t.me/i3kara"><span class="footer-icon-container"><i class="fab fa-telegram"></i></span></a></li>
                        <li class="list-inline-item"><a href="mailto:adm1n.3kara@protonmail.com"><span class="footer-icon-container"><i class="far fa-envelope"></i></span></a></li>
                        <li class="list-inline-item"><a href="https://discord.gg/4uuuqHp"><span class="footer-icon-container"><i class="fab fa-discord"></i></span></a></li>
                                                                       
                    </ul>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                    <div class="footer-copyright">
                        All rights reserved &copy; 3kara <script>document.write(new Date().getFullYear());</script> You reap what you sow

                    </div>
                </div>
            </div>
        </div>
       
    </footer>
     
    <!-- After footer scripts -->
    
    <script src="//code.jquery.com/jquery-2.1.4.min.js"></script> <!-- jQuery -->    
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script> <!-- Tween Max --> 
    <script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script> <!-- Gallery -->
    <script src="/js/main.js"></script>
    
    </body>
    
    </html>
